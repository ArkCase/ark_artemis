#!/bin/bash

set -euo pipefail
. /.functions

ARTIFACT_IDS=(
	org.eclipse.jetty:jetty-alpn-java-server@LIB_DIR
	org.eclipse.jetty:jetty-alpn-server@LIB_DIR
	org.eclipse.jetty:jetty-ee@LIB_DIR
	org.eclipse.jetty:jetty-http@LIB_DIR
	org.eclipse.jetty:jetty-io@LIB_DIR
	org.eclipse.jetty:jetty-security@LIB_DIR
	org.eclipse.jetty:jetty-server@LIB_DIR
	org.eclipse.jetty:jetty-session@LIB_DIR
	org.eclipse.jetty:jetty-util@LIB_DIR
	org.eclipse.jetty:jetty-xml@LIB_DIR

	org.eclipse.jetty.ee9:jetty-ee9-nested@LIB_DIR
	org.eclipse.jetty.ee9:jetty-ee9-security@LIB_DIR
	org.eclipse.jetty.ee9:jetty-ee9-servlet@LIB_DIR
	org.eclipse.jetty.ee9:jetty-ee9-webapp@LIB_DIR

	org.eclipse.jetty.http2:jetty-http2-common@LIB_DIR
	org.eclipse.jetty.http2:jetty-http2-hpack@LIB_DIR
	org.eclipse.jetty.http2:jetty-http2-server@LIB_DIR
)

set_or_default BASE_DIR "/app"
set_or_default HOME_DIR "${BASE_DIR}/artemis"
set_or_default LIB_DIR "${HOME_DIR}/lib"

export LIB_DIR
exec fix-jars "CVE-2025-5115" "12.0.25" "${ARTIFACT_IDS[@]}"
